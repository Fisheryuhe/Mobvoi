<?xml version="1.0" encoding="utf-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
	<bean id="job" class="com.mobvoi.be.usercenter.datamining.UserCenterDataMiningJob">
		<property name="logTool" ref="logTool" />
		<property name="extractorTool" ref="extractorTool" />
		<property name="handlerTool" ref="handlerTool" />
		<property name="uploaderTool" ref="uploaderTool" />
		<property name="rootPath" value="./location" />
		<property name="lockPath" value="./location/test_lock" />
		<property name="statusPath" value="./location/test_status" /> 
	</bean>
	
	<bean id="logTool" class="com.mobvoi.be.usercenter.datamining.log.LogDownloadTool">
		<property name="logPath" value="./location/log" />
		<property name="job" ref="job" />
		<property name="name2Pattern">
			<map>
				<entry key="heartbeat" value="heartbeat.record.*" />
			</map>
		</property>
	</bean>
	
	<bean id="extractorTool" class="com.mobvoi.be.usercenter.datamining.extract.DataExtractorTool">
		<property name="logPath" value="./location/log" />
		<property name="dataPath" value="./location/data" />
		<property name="inMemorySize" value="2000000" />
		<property name="extractors">
			<map>
				<entry key="heartbeat" value-ref="heartbeatLocationExtractor" />
			</map>
		</property>
	</bean>
	
	<bean id="heartbeatLocationExtractor" class="com.mobvoi.be.usercenter.datamining.extract.HeartbeatLocationExtractor" />

	<bean id="handlerTool" class="com.mobvoi.be.usercenter.datamining.handle.DataHandlerTool">
		<property name="dataPath" value="./location/data" />
		<property name="resultPath" value="./location/result" />
		<property name="dataClass" value="com.mobvoi.be.usercenter.datamining.model.LocationData" />
		<property name="handlers">
			<map>
				<entry key="location_test_set" value-ref="locationTestSetHandler" />
			</map>
		</property>
	</bean>
	
	<bean id="locationTestSetHandler" class="com.mobvoi.be.usercenter.datamining.handle.LocationTestSetHandler" init-method="init">
		<property name="distance" value="1000" />
		<property name="threshold" value="20" />
		<property name="locationTypes">
			<list>
				<value>家</value>
				<value>公司</value>
			</list>
		</property>
	</bean>
	
	<!-- <bean id="home" class="" />  -->
	
	<bean id="uploaderTool" class="com.mobvoi.be.usercenter.datamining.upload.ResultUploaderTool">
		<property name="resultPath" value="./location/test_result" />
		<property name="uploaders">
			<map>
			</map>
		</property>
		<property name="classes">
			<map>
			</map>
		</property>
	</bean>

</beans>
